# 验收清单 (Checklist)

## 基础功能与数据库
- [ ] `Conversation` 模型新增 `current_mode` 字段。
- [ ] `Repository` 模型新增 `dingtalk_webhook` 字段。
- [ ] 数据库迁移成功 (`python manage.py migrate`)。

## 智能体框架
- [ ] `Dispatcher` 能够根据用户输入正确路由到 `CodeReviewAgent` 或 `KnowledgeAgent`。
- [ ] `BaseAgent` 接口定义清晰，子类可复用。

## 代码评审智能体
- [ ] 对话触发：输入“评审 [仓库名]”能正确进入评审流程。
- [ ] 状态机流转：
    - [ ] 能够询问评审模式（单次提交 vs 分支对比）。
    - [ ] 能够询问分支名称（如输入 dev）。
- [ ] 步骤反馈：
    - [ ] 能够实时显示“正在拉取仓库”、“正在获取Diff”、“正在评审”、“正在发送钉钉”的进度条或日志。
    - [ ] 步骤完成后显示 ✅。
- [ ] 核心功能：
    - [ ] 成功执行 `git pull`。
    - [ ] 成功获取正确的分支 Diff（`git diff`）。
    - [ ] 成功调用 DeepSeek API 进行评审并返回建议。
    - [ ] 成功发送钉钉通知（需配置有效 Webhook）。

## Agentic RAG 智能体
- [ ] 对话触发：输入复杂问题（如“对比 DeepSeek V3 和本地部署方案”）能触发 Agentic RAG。
- [ ] 推理过程：
    - [ ] 能够显示“正在思考...”或类似的加载状态。
    - [ ] 能够展示使用了哪些工具（Web Search, Knowledge Base）。
    - [ ] 能够展示中间步骤的观察结果（Observation）。
- [ ] 最终回答：
    - [ ] 回答准确且基于检索到的信息。
    - [ ] 包含引用来源（如“根据 [网页标题]...”）。

## 前端体验
- [ ] 步骤条组件渲染正常，无错位。
- [ ] 思考过程折叠/展开功能可用。
- [ ] 能够中断正在进行的 Agent 任务（可选）。
